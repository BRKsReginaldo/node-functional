"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const chalk_1 = require("chalk");
const logger_util_1 = require("./logger.util");
const colorizeStatusCode = (statusCode) => statusCode >= 400
    ? chalk_1.default.yellow(statusCode.toString())
    : chalk_1.default.green(statusCode.toString());
exports.prepareLogString = (opts) => !!opts.timestamp
    ? `${opts.timestamp} ${opts.method} ${opts.url} ${opts.statusCode} ${opts.time}`
    : `${opts.method} ${opts.url} ${opts.statusCode} ${opts.time}`;
exports.factorizeLog = (res, stamp) => (opts = {}) => {
    const { method, url } = stamp.value;
    const now = Date.now();
    const timestamp = opts.timestamp
        ? new Date(now).toISOString()
        : '';
    const statusCode = opts.colorize
        ? colorizeStatusCode(res.statusCode)
        : String(res.statusCode);
    const time = logger_util_1.factorizeTime(stamp.timestamp);
    return exports.prepareLogString({ timestamp, method, url, statusCode, time });
};
