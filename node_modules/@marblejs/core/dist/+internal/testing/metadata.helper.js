"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.TESTING_HEADER = 'X-Marble-Testing';
exports.stripMetadataHeader = (headers) => {
    const key = exports.TESTING_HEADER.toLowerCase();
    const header = headers[key];
    delete headers[key];
    return JSON.parse(decodeURIComponent(header));
};
exports.isTestingMetadataOn = () => process.env.MARBLE_TESTING_METADATA_ON === 'true';
exports.setMetadataHeader = (response, meta) => response.setHeader(exports.TESTING_HEADER, encodeURIComponent(JSON.stringify(meta)));
exports.applyMetadata = (req, res) => {
    if (!exports.isTestingMetadataOn()) {
        return;
    }
    exports.setMetadataHeader(res, Object.assign({}, req.meta));
};
